{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#welcome-to-the-fairness-aware-multi-agent-imitation-learning-project","title":"Welcome to the Fairness-Aware Multi Agent Imitation Learning Project","text":"<p>FAMAIL</p> <p> FAMAIL is a research project at San Diego State University that addresses spatial inequality in urban taxi services. Using GPS trajectory data from Shenzhen, China, we develop trajectory editing techniques that modify expert driver trajectories to improve fairness metrics \u2014 ensuring that all areas of a city receive equitable taxi service \u2014 while maintaining the behavioral realism of the original trajectories. </p> <p>Dr. Xin Zhang (Advisor)Robert Ashe (Researcher)San Diego State University \u00b7 Department of Computer Science</p>"},{"location":"#the-challenge","title":"The Challenge","text":"<p>Taxi services in cities like Shenzhen exhibit significant spatial inequality. Certain areas \u2014 often wealthier, centrally-located neighborhoods \u2014 receive disproportionately more service relative to demand, while other areas \u2014 frequently lower-income or peripheral neighborhoods \u2014 are systematically underserved. When this inequality correlates with socioeconomic factors, it raises a systemic fairness concern in urban mobility.</p> <p>Learn more about the problem \u2192</p>"},{"location":"#our-approach","title":"Our Approach","text":"<p>Rather than generating entirely new synthetic trajectories, FAMAIL edits existing expert driver trajectories \u2014 applying small, bounded adjustments to real-world GPS data to improve the equity of taxi service distribution. This preserves the expert knowledge embedded in real driver behavior while steering the overall service pattern toward fairness.</p> 1 Identify <p>Rank trajectories by their contribution to spatial inequality</p> \u2192 2 Edit <p>Modify pickup locations using gradient-based optimization</p> \u2192 3 Validate <p>Verify edited trajectories remain behaviorally realistic</p>"},{"location":"#explore-the-project","title":"Explore the Project","text":"<p> The FAMAIL Project \u2014 2025\u20132026 </p>"},{"location":"#research-goals","title":"Research Goals","text":"<p>Four interrelated objectives \u2014 from multi-objective optimization to imitation learning.</p> <p>Research Goals \u2192</p>"},{"location":"#methodology","title":"Methodology","text":"<p>A two-phase pipeline combining attribution-based trajectory selection with gradient-based editing.</p> <p>Two-Phase Pipeline \u2192</p>"},{"location":"#objective-function","title":"Objective Function","text":"<p>Three terms \u2014 spatial fairness, causal fairness, and trajectory fidelity \u2014 in a single differentiable objective.</p> <p>Objective Function \u2192</p>"},{"location":"#study-area-data","title":"Study Area &amp; Data","text":"<p>Real-world GPS taxi data from Shenzhen, China \u2014 50 expert drivers, 4,320 grid cells, 288 daily time buckets.</p> <p>Study Area \u2192</p>"},{"location":"#fairness","title":"Fairness","text":"<p>Two complementary lenses: spatial equality of service and causal independence from demographics.</p> <p>Fairness Definitions \u2192</p>"},{"location":"#discriminator","title":"Discriminator","text":"<p>A Siamese LSTM network that validates whether edited trajectories remain authentic.</p> <p>ST-SiameseNet \u2192</p>"},{"location":"fairness/","title":"What Does \"Fairness\" Mean in FAMAIL?","text":"<p>FAMAIL operationalizes fairness through two complementary lenses, each capturing a different aspect of equitable service distribution.</p>"},{"location":"fairness/#spatial-fairness-equal-access-to-service","title":"Spatial Fairness: Equal Access to Service","text":"<p>Spatial fairness asks: Is taxi service distributed equally across the city?</p> <p>We measure this using the Gini coefficient \u2014 the same measure economists use to quantify income inequality \u2014 applied to taxi service rates. For each grid cell, we compute a service rate by normalizing the number of pickups (or dropoffs) by the number of active taxis available in that area. This controls for the fact that some areas simply have more taxis present.</p>   $$G(\\mathbf{x}) = \\frac{\\sum_{i}\\sum_{j} |x_i - x_j|}{2n^2 \\bar{x}}$$   <p>A Gini coefficient of 0 represents perfect equality (every cell has the same service rate), while a coefficient of 1 represents maximum inequality (all service is concentrated in a single cell).</p> <p>Intuition: If two neighborhoods have the same number of available taxis, they should have roughly similar pickup rates. Large deviations indicate that some areas are systematically favored over others.</p>"},{"location":"fairness/#causal-fairness-service-driven-by-demand-not-demographics","title":"Causal Fairness: Service Driven by Demand, Not Demographics","text":"<p>Causal fairness asks a deeper question: Is the service distribution explained by legitimate factors (demand) rather than sensitive factors (demographics)?</p> <p>It is acceptable \u2014 even expected \u2014 that areas with higher passenger demand receive more service. What is not acceptable is when two areas with the same demand receive different levels of service because one is wealthier than the other.</p> <p>FAMAIL measures causal fairness by:</p> <ol> <li>Modeling the demand-service relationship: What service level should each area receive, given its level of demand?</li> <li>Computing residuals: How much does the actual service deviate from the demand-predicted level?</li> <li>Checking for demographic bias: Do those residuals correlate with neighborhood demographics (income, housing prices, etc.)?</li> </ol> <p>If service deviations are independent of demographics, the system achieves causal fairness \u2014 service allocation is driven by demand alone, not by where wealthy or poor residents live.</p>"},{"location":"fairness/#why-both","title":"Why Both?","text":"<p>These two fairness measures are complementary, and neither alone is sufficient:</p> Scenario Spatial Fairness Causal Fairness Assessment Equal service everywhere, but driven by demographics High Low Not truly fair \u2014 equality is coincidental Unequal service, but fully explained by demand Low High Not truly fair \u2014 some areas are still underserved Equal service driven by demand High High Genuinely fair <p>The goal</p> <p>True fairness requires both: equitable distribution (spatial) that is driven by legitimate factors (causal). The objective function captures both through separate, weighted terms.</p>"},{"location":"problem/","title":"The Urban Taxi Fairness Problem","text":"<p>Taxi services in cities like Shenzhen exhibit significant spatial inequality. Certain areas \u2014 often wealthier, centrally-located neighborhoods \u2014 receive disproportionately more service relative to demand, while other areas \u2014 frequently lower-income or peripheral neighborhoods \u2014 are systematically underserved.</p>"},{"location":"problem/#how-inequality-emerges","title":"How Inequality Emerges","text":"<p>This inequality arises naturally from expert driver behavior: drivers learn to optimize for personal revenue, gravitating toward high-demand, high-tip areas and avoiding less profitable zones. Over time, this creates a self-reinforcing cycle:</p> <ul> <li>High-service areas attract more taxis \u2192 shorter wait times \u2192 more riders \u2192 more revenue</li> <li>Low-service areas have fewer taxis \u2192 longer wait times \u2192 fewer riders \u2192 less incentive for drivers</li> </ul> <p>When this spatial inequality correlates with socioeconomic factors \u2014 such as neighborhood income levels \u2014 it raises a systemic fairness issue in urban mobility.</p> <p>The Central Question</p> <p>Can we modify how taxi drivers serve a city to make the distribution of service more equitable \u2014 without compromising the realism of driver behavior?</p>"},{"location":"problem/#why-this-matters","title":"Why This Matters","text":"<p>Transportation equity is a growing concern in urban planning and policy. Access to reliable taxi service affects:</p> <ul> <li>Economic participation \u2014 residents in underserved areas face longer commutes and reduced mobility</li> <li>Equity of opportunity \u2014 service patterns may reinforce existing socioeconomic divides</li> <li>Policy design \u2014 understanding the mechanisms of inequality enables targeted interventions</li> </ul> <p>FAMAIL addresses this challenge by developing algorithmic tools that can reshape the spatial distribution of taxi service while preserving realistic driving patterns.</p>"},{"location":"approach/goals/","title":"Research Goals","text":"<p>FAMAIL pursues four interrelated research objectives:</p>"},{"location":"approach/goals/#1-multi-objective-function","title":"1. Multi-Objective Function","text":"<p>Develop a multi-objective function that balances fairness with trajectory fidelity.</p> <p>The objective function must simultaneously capture spatial equality, demand alignment, and behavioral realism \u2014 and it must be fully differentiable to support gradient-based optimization.</p> \\[\\mathcal{L} = \\alpha_1 \\cdot F_{\\text{spatial}} + \\alpha_2 \\cdot F_{\\text{causal}} + \\alpha_3 \\cdot F_{\\text{fidelity}}\\] <p>Learn more about the objective function \u2192</p>"},{"location":"approach/goals/#2-trajectory-modification-algorithm","title":"2. Trajectory Modification Algorithm","text":"<p>Create a trajectory modification algorithm that iteratively improves fairness.</p> <p>The algorithm must efficiently identify which trajectories to modify, determine how to modify them, and do so within realistic spatial constraints. FAMAIL adapts the ST-iFGSM algorithm \u2014 originally designed for adversarial attacks on trajectory classifiers \u2014 as a tool for fairness-aware trajectory editing.</p> <p>Learn more about the algorithm \u2192</p>"},{"location":"approach/goals/#3-discriminator-model","title":"3. Discriminator Model","text":"<p>Build a discriminator model to validate trajectory authenticity.</p> <p>Edited trajectories must remain indistinguishable from genuine expert trajectories. A Siamese LSTM neural network (modified ST-SiameseNet) serves as a learned \"realism check,\" ensuring that modifications preserve the behavioral signature of the original driver.</p> <p>Learn more about the discriminator \u2192</p>"},{"location":"approach/goals/#4-imitation-learning-agents","title":"4. Imitation Learning Agents","text":"<p>Train imitation learning agents on fairness-edited trajectories.</p> <p>The ultimate downstream application: agents that learn equitable service patterns from edited expert demonstrations. By embedding fairness into the training data itself, the resulting policies should naturally produce more equitable service distributions.</p> <p>Current Status</p> <p>Goals 1\u20133 are the focus of ongoing development. Goal 4 represents the downstream application that will follow once the trajectory editing framework is validated.</p>"},{"location":"approach/overview/","title":"What is FAMAIL?","text":"<p>FAMAIL (Fairness-Aware Multi-Agent Imitation Learning) takes a novel approach to the urban taxi fairness problem: rather than generating entirely new synthetic trajectories, we edit existing expert driver trajectories to improve fairness.</p>"},{"location":"approach/overview/#trajectory-editing-vs-generation","title":"Trajectory Editing vs. Generation","text":"<p>This editing approach is central to the project's philosophy:</p> Approach Description FAMAIL? Trajectory Generation Create entirely new synthetic trajectories from scratch \u2717 Trajectory Editing Apply small, bounded adjustments to real expert trajectories \u2713"},{"location":"approach/overview/#why-editing","title":"Why Editing?","text":"<p>Editing is preferred for several reasons:</p> <ol> <li> <p>Preserves expert knowledge. Driving patterns, route choices, and temporal behaviors are retained from the original human drivers.</p> </li> <li> <p>Maximizes efficiency. Not all trajectories contribute equally to global unfairness, so only the most impactful trajectories are modified.</p> </li> <li> <p>Bounded modifications. Spatial constraints limit how far pickup locations can move, ensuring modifications remain realistic.</p> </li> <li> <p>Enables fidelity validation. A neural network discriminator can verify that a modified trajectory still \"looks like\" it came from the same driver.</p> </li> </ol>"},{"location":"approach/overview/#the-famail-pipeline","title":"The FAMAIL Pipeline","text":"1 Identify Unfair Trajectories <p>Which trajectories contribute most to spatial inequality?</p> \u2192 2 Edit Pickup Locations <p>Move pickup locations toward underserved areas</p> \u2192 3 Validate Fidelity <p>Does the edited trajectory still look realistic?</p>"},{"location":"approach/overview/#long-term-vision","title":"Long-Term Vision","text":"<p>The edited trajectories are ultimately intended to serve as training data for imitation learning agents. By training agents on fairness-improved demonstrations, we aim to produce autonomous taxi policies that naturally distribute service more equitably \u2014 embedding fairness directly into learned driving behavior.</p> <pre><code>Expert GPS Trajectories\n        \u2502\n        \u25bc\n  FAMAIL Trajectory Editing\n  (Identify \u2192 Edit \u2192 Validate)\n        \u2502\n        \u25bc\n  Fairness-Improved Trajectories\n        \u2502\n        \u25bc\n  Train Imitation Learning Agents\n  on Fairer Expert Demonstrations\n</code></pre>"},{"location":"data/study-area/","title":"Study Area and Data Sources","text":""},{"location":"data/study-area/#study-area","title":"Study Area","text":"<p>The FAMAIL framework operates on real-world GPS taxi trajectory data from Shenzhen, China \u2014 one of the largest and most economically dynamic cities in southern China. Shenzhen's taxi fleet is one of the densest in the world, and the city's rapid economic growth has produced significant variation in neighborhood wealth and service access \u2014 making it an ideal setting for studying fairness in urban transportation.</p>"},{"location":"data/study-area/#spatial-and-temporal-resolution","title":"Spatial and Temporal Resolution","text":"Parameter Value Geographic area Shenzhen, China Spatial grid 48 \u00d7 90 cells (~1.1 km per cell) Total grid cells 4,320 Temporal resolution 288 time buckets per day (5-minute intervals) Analysis period July\u2013September 2016 (weekdays only) Fleet 50 expert taxi drivers (subset of 17,877 total)"},{"location":"data/study-area/#data-sources","title":"Data Sources","text":"<p>The project uses three primary data sources, all derived from GPS traces of the 50 expert drivers:</p>"},{"location":"data/study-area/#1-taxi-trajectories","title":"1. Taxi Trajectories","text":"<p>GPS-derived trajectory sequences recording each driver's path from the start of passenger-seeking behavior to the pickup event. Each trajectory is a sequence of spatiotemporal states \u2014 grid cell coordinates and time-of-day \u2014 capturing the driver's movement through the city.</p>"},{"location":"data/study-area/#2-pickup-and-dropoff-counts","title":"2. Pickup and Dropoff Counts","text":"<p>Aggregated event data recording how many passenger pickups and dropoffs occurred at each grid cell, in each 5-minute time window, on each day. This serves as the empirical measure of taxi service distribution across the city.</p>"},{"location":"data/study-area/#3-active-taxi-counts","title":"3. Active Taxi Counts","text":"<p>For each grid cell and time period, how many unique taxis were present in the surrounding neighborhood. This measures taxi supply \u2014 how many drivers were available to serve each area \u2014 and is essential for computing service rates that account for taxi availability.</p>"},{"location":"data/study-area/#demographic-data","title":"Demographic Data","text":"<p>District-level demographic data for Shenzhen's 10 administrative districts provides the basis for measuring whether service inequality correlates with socioeconomic factors. Key indicators include:</p> <ul> <li>GDP per capita</li> <li>Average housing price</li> <li>Employee compensation per capita</li> <li>Population density</li> </ul> <p>Each grid cell is mapped to its majority-overlap Shenzhen district via ArcGIS spatial analysis, allowing demographic attributes to be associated with service patterns at the grid level.</p> <p>Why normalize by active taxis?</p> <p>Raw pickup counts can be misleading \u2014 a cell might have few pickups simply because few taxis pass through it. By dividing by the number of active taxis, we obtain a service rate that measures how effectively taxis serve an area given their presence. This is the quantity that the spatial fairness metric operates on.</p>"},{"location":"methodology/algorithm/","title":"ST-iFGSM: Gradient-Based Trajectory Editing","text":"<p>FAMAIL adapts the Spatio-Temporal iterative Fast Gradient Sign Method (ST-iFGSM) \u2014 originally developed for adversarial attacks on trajectory classifiers \u2014 as a tool for fairness-aware trajectory editing. Instead of fooling a classifier, the algorithm moves pickup locations in the direction that most improves the combined fairness objective.</p>"},{"location":"methodology/algorithm/#algorithm","title":"Algorithm","text":"**ALGORITHM:** FAMAIL Trajectory Modification  **INPUT:** $T$ trajectories, objective function $\\mathcal{L}$, step size $\\alpha$, perturbation bound $\\epsilon$, max iterations $T_{\\max}$, temperature schedule $\\{\\tau_t\\}$  **OUTPUT:** Modified trajectories with improved fairness  ---  **Phase 1: Attribution**  1. **FOR** each trajectory $\\tau$:     - Compute $\\text{LIS}(\\tau)$ \u2014 spatial inequality contribution     - Compute $\\text{DCD}(\\tau)$ \u2014 demand-conditional deviation     - $\\text{Score}(\\tau) = w_{\\text{LIS}} \\cdot \\text{LIS}(\\tau) + w_{\\text{DCD}} \\cdot \\text{DCD}(\\tau)$  2. **SELECT** top-$k$ trajectories by Score (highest impact on unfairness)  ---  **Phase 2: Modification**  3. **FOR** each selected trajectory $\\tau$:      - Initialize: $\\mathbf{p} \\leftarrow$ original pickup location, $\\delta_{\\text{total}} \\leftarrow 0$  4. \u2003**FOR** $t = 1, 2, \\ldots, T_{\\max}$:      - **(a)** Compute soft cell probabilities $\\sigma_c(\\mathbf{p};\\, \\tau_t)$     - **(b)** Evaluate combined objective: $\\mathcal{L} = \\alpha_1 F_{\\text{spatial}} + \\alpha_2 F_{\\text{causal}} + \\alpha_3 F_{\\text{fidelity}}$     - **(c)** Compute gradient: $\\nabla_\\mathbf{p} \\mathcal{L}$ via backpropagation     - **(d)** Compute perturbation: $\\delta = \\text{clip}(\\alpha \\cdot \\text{sign}(\\nabla_\\mathbf{p} \\mathcal{L}),\\, -\\epsilon,\\, \\epsilon)$     - **(e)** Update cumulative perturbation: $\\delta_{\\text{total}} = \\text{clip}(\\delta_{\\text{total}} + \\delta,\\, -\\epsilon,\\, \\epsilon)$     - **(f)** Update pickup location: $\\mathbf{p} \\leftarrow \\text{clip}(\\mathbf{p}_{\\text{original}} + \\delta_{\\text{total}},\\, \\text{grid\\_bounds})$     - **(g)** **IF** $|\\mathcal{L}_t - \\mathcal{L}_{t-1}| &lt; \\text{threshold}$: **BREAK** (converged)  5. \u2003Update global pickup counts: decrement original cell, increment new cell  6. **EVALUATE** updated global fairness metrics"},{"location":"methodology/algorithm/#key-properties","title":"Key Properties","text":"<p>Sign gradient. The \\(\\text{sign}(\\cdot)\\) function normalizes the gradient to unit magnitude in each dimension, making the step size independent of gradient scale. This is the hallmark of FGSM-type methods.</p> <p>Cumulative clipping. The total perturbation is always bounded by \\([-\\epsilon, \\epsilon]\\) per dimension, regardless of how many iterations run. A pickup can move at most \\(\\epsilon\\) cells from its original location.</p> <p>Sequential processing. Trajectories are modified one at a time, with global counts updated after each edit. This ensures each modification accounts for previous changes to the service distribution.</p> <p>Temperature annealing. The soft cell assignment temperature decreases over iterations, transitioning from smooth exploration (broad gradients) to precise assignment (accurate cell counts).</p>"},{"location":"methodology/algorithm/#adaptation-from-adversarial-ml","title":"Adaptation from Adversarial ML","text":"Concept Original ST-iFGSM (Adversarial) FAMAIL Adaptation Objective Adversarial loss (fool classifier) Fairness objective \\(\\mathcal{L}\\) Direction Maximize loss (attack) Maximize fairness (improve) Perturbation space Continuous feature space Continuous grid coordinates Constraint \\(L_\\infty\\) norm bound \\(\\epsilon\\) grid cell bound Discretization N/A Soft cell assignment bridges continuous \u2192 discrete <p>Reframing adversarial methods for social good</p> <p>The core insight of FAMAIL is that adversarial perturbation techniques \u2014 designed to attack models \u2014 can be repurposed as optimization tools for improving fairness. The mathematical machinery is the same; only the objective changes.</p>"},{"location":"methodology/discriminator/","title":"ST-SiameseNet: Validating Trajectory Authenticity","text":"<p>When we modify a trajectory, how do we know the result still looks like a real taxi trip? FAMAIL uses a Siamese LSTM neural network \u2014 called ST-SiameseNet \u2014 that has been trained to determine whether two trajectory sequences were generated by the same driver.</p>"},{"location":"methodology/discriminator/#architecture-overview","title":"Architecture Overview","text":"<p>The discriminator takes two trajectories as input and outputs a similarity score between 0 and 1:</p> <pre><code>                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\nOriginal Trajectory \u03c4  \u2500\u2500\u2192\u2502              \u2502\n                          \u2502   Shared     \u2502\n                          \u2502   LSTM       \u2502\u2500\u2500\u2192  Compare  \u2500\u2500\u2192  Similarity\n                          \u2502   Encoder    \u2502        \u2191          Score \u2208 [0, 1]\nModified Trajectory \u03c4\u2032 \u2500\u2500\u2192\u2502              \u2502        \u2502\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n                          (shared weights)    MLP + Sigmoid\n</code></pre>"},{"location":"methodology/discriminator/#input","title":"Input","text":"<p>Each trajectory is a sequence of spatiotemporal states: grid coordinates, time of day, and day of week.</p>"},{"location":"methodology/discriminator/#encoding","title":"Encoding","text":"<p>A bidirectional LSTM with shared weights processes both trajectories into fixed-length vector representations. Sharing weights ensures that both trajectories are embedded into the same feature space, enabling meaningful comparison.</p>"},{"location":"methodology/discriminator/#comparison","title":"Comparison","text":"<p>The two representations are compared via a multi-layer perceptron (MLP) that outputs \\(P(\\text{same driver})\\).</p>"},{"location":"methodology/discriminator/#output","title":"Output","text":"<ul> <li>Score \\(\\approx 1.0\\): The modified trajectory is indistinguishable from the original \u2014 the edit preserves the driver's behavioral signature.</li> <li>Score \\(\\approx 0.0\\): The modification has altered the trajectory so much that it no longer resembles the original driver's behavior.</li> </ul>"},{"location":"methodology/discriminator/#role-in-the-optimization","title":"Role in the Optimization","text":"<p>During trajectory modification, the discriminator is frozen \u2014 its parameters are not updated. However, gradients flow through the discriminator back to the modified trajectory, allowing the optimizer to learn which modifications preserve driver-consistent behavior.</p> <p>The fidelity score acts as a regularization term in the objective function:</p> \\[\\mathcal{L} = \\alpha_1 \\cdot F_{\\text{spatial}} + \\alpha_2 \\cdot F_{\\text{causal}} + \\alpha_3 \\cdot F_{\\text{fidelity}}\\] <p>This prevents the optimizer from making unrealistically large location shifts just to improve fairness metrics. The discriminator anchors the modifications to behavioral reality.</p>"},{"location":"methodology/discriminator/#why-a-siamese-architecture","title":"Why a Siamese Architecture?","text":"<p>Traditional classifiers answer \"is this trajectory real?\" \u2014 a question that requires defining what \"real\" means in absolute terms. The Siamese architecture instead answers a relative question: \"do these two trajectories look like they came from the same driver?\"</p> <p>This relative framing is ideal for FAMAIL because:</p> <ul> <li>We always have the original trajectory as a reference point</li> <li>We care about the degree of change, not absolute quality</li> <li>The shared encoder naturally learns driver-invariant features</li> </ul> <p>Pre-trained and frozen</p> <p>ST-SiameseNet is trained once on the full trajectory dataset, then frozen during the optimization loop. Only the trajectory pickup locations are modified \u2014 the discriminator provides gradient signal but is never updated.</p>"},{"location":"methodology/objective-function/","title":"The Multi-Objective Function","text":"<p>At the heart of FAMAIL is a multi-objective function that simultaneously optimizes three goals. The objective is expressed as a weighted sum:</p>   $$\\mathcal{L} = \\alpha_1 \\cdot F_{\\text{spatial}} + \\alpha_2 \\cdot F_{\\text{causal}} + \\alpha_3 \\cdot F_{\\text{fidelity}}$$   <p>where \\(\\sum_{i} \\alpha_i = 1\\) and each term lies in \\([0, 1]\\). The objective is maximized \u2014 higher values indicate fairer, more realistic outcomes.</p>"},{"location":"methodology/objective-function/#the-three-terms","title":"The Three Terms","text":"Term Name What It Measures Goal \\(F_{\\text{spatial}}\\) Spatial Fairness Equality of taxi service distribution across all grid cells Equalize service so no area is systematically over- or under-served \\(F_{\\text{causal}}\\) Causal Fairness Whether service allocation aligns with demand rather than demographic factors Ensure service is driven by genuine demand, not neighborhood wealth \\(F_{\\text{fidelity}}\\) Trajectory Fidelity Whether modified trajectories remain behaviorally realistic Preserve the authenticity of expert driving patterns"},{"location":"methodology/objective-function/#spatial-fairness-f_textspatial","title":"Spatial Fairness - \\(F_{\\text{spatial}}\\)","text":"<p>Spatial fairness uses the Gini coefficient \u2014 a widely-used inequality measure from economics \u2014 applied to taxi service rates across the city grid. Service rates are computed by normalizing raw pickup and dropoff counts by the number of active taxis in each cell, isolating true service inequality from differences in taxi presence.</p>   $$F_{\\text{spatial}} = 1 - \\frac{1}{2}\\left(G_{\\text{pickup}} + G_{\\text{dropoff}}\\right)$$   <p>where:</p> <ul> <li>\\(G = 0\\): Perfect equality (identical service rates everywhere)</li> <li>\\(G = 1\\): Maximum inequality (all service concentrated in one cell)</li> <li>\\(F_{\\text{spatial}} = 1\\): Perfectly fair; \\(F_{\\text{spatial}} = 0\\): Maximally unfair</li> </ul> <p>For more context on the Gini coefficient and its interpretation, see the Fairness Definitions page.</p>"},{"location":"methodology/objective-function/#causal-fairness-f_textcausal","title":"Causal Fairness - \\(F_{\\text{causal}}\\)","text":"<p>Causal fairness asks a deeper question than spatial fairness: not just \"is service equal?\" but \"is service driven by the right factors?\" Specifically, it measures whether the variance in service ratios across the city can be explained by demand patterns rather than by sensitive demographic attributes like neighborhood income.</p> <p>The term uses the coefficient of determination (\\(R^2\\)) to quantify how well a demand-based model predicts the observed service distribution. Higher \\(R^2\\) means more of the service variation is explained by demand \u2014 and less by potentially unfair demographic factors.</p>"},{"location":"methodology/objective-function/#trajectory-fidelity-f_textfidelity","title":"Trajectory Fidelity - \\(F_{\\text{fidelity}}\\)","text":"<p>Fidelity ensures that trajectory edits remain realistic. A neural network discriminator evaluates each modified trajectory against the original, producing a similarity score:</p> <ul> <li>\\(F_{\\text{fidelity}} \\approx 1\\): The modified trajectory is indistinguishable from the original (good).</li> <li>\\(F_{\\text{fidelity}} \\approx 0\\): The modification is so large that the trajectory no longer resembles the driver's behavior (bad).</li> </ul> <p>Fidelity acts as a regularizer, preventing the optimizer from making arbitrarily large changes just to improve fairness.</p>"},{"location":"methodology/objective-function/#differentiability","title":"Differentiability","text":"<p>All three terms \u2014 and the entire optimization pipeline \u2014 are fully differentiable, enabling gradient-based optimization. This is made possible by a key technical innovation: soft cell assignment, which bridges the gap between continuous pickup locations and discrete grid cell counts.</p> <p>Design Principle</p> <p>By formulating all objectives as differentiable functions in \\([0, 1]\\) (higher is better), the terms can be freely combined with different weight configurations to explore the trade-off space between fairness and fidelity.</p>"},{"location":"methodology/pipeline/","title":"Two-Phase Trajectory Modification","text":"<p>The FAMAIL trajectory modification algorithm operates in two phases, applied iteratively.</p>"},{"location":"methodology/pipeline/#phase-1-attribution","title":"Phase 1: Attribution","text":"<p>\"Which trajectories should we modify?\"</p> <p>Not all trajectories contribute equally to unfairness. The attribution phase ranks every trajectory by its impact on global inequality, using two complementary scoring methods:</p>"},{"location":"methodology/pipeline/#local-inequality-score-lis","title":"Local Inequality Score (LIS)","text":"<p>How much does this trajectory's pickup or dropoff cell deviate from the citywide average service rate? Trajectories in cells far above or below the mean receive high scores.</p> \\[\\text{LIS}_c = \\frac{|c_{\\text{count}} - \\mu|}{\\mu}\\]"},{"location":"methodology/pipeline/#demand-conditional-deviation-dcd","title":"Demand-Conditional Deviation (DCD)","text":"<p>How much does the actual service in this trajectory's pickup cell deviate from what we would expect given the level of demand? Trajectories in cells that are over- or under-served relative to demand receive high scores.</p> \\[\\text{DCD}_c = |Y_c - g(D_c)|\\]"},{"location":"methodology/pipeline/#combined-ranking","title":"Combined Ranking","text":"<p>These scores are normalized to \\([0, 1]\\) and combined into a single ranking:</p> \\[\\text{Score}_\\tau = w_{\\text{LIS}} \\cdot \\widetilde{\\text{LIS}}_\\tau + w_{\\text{DCD}} \\cdot \\widetilde{\\text{DCD}}_\\tau\\] <p>The top-\\(k\\) highest-impact trajectories are selected for editing.</p>"},{"location":"methodology/pipeline/#phase-2-modification","title":"Phase 2: Modification","text":"<p>\"How should we change them?\"</p> <p>Selected trajectories are individually modified using a gradient-based optimization algorithm (ST-iFGSM) that iteratively adjusts pickup locations to improve the combined fairness objective:</p> <ol> <li>Compute the gradient of the objective function with respect to the trajectory's pickup location.</li> <li>Apply a small, bounded perturbation in the gradient direction.</li> <li>Iterate until the objective converges or a maximum number of iterations is reached.</li> <li>Update global service counts to reflect the change before moving to the next trajectory.</li> </ol>"},{"location":"methodology/pipeline/#key-constraints","title":"Key Constraints","text":"<p>The modification algorithm enforces several constraints to ensure realistic edits:</p> Constraint Description Spatial bound (\\(\\epsilon\\)) No pickup location can move more than \\(\\epsilon\\) grid cells (~3.3 km) from its original position in any direction Grid boundary Modified locations are projected back within the valid study area Fidelity validation A discriminator network evaluates whether the edited trajectory remains behaviorally consistent with the original driver Sequential processing Trajectories are modified one at a time, with global counts updated after each edit"},{"location":"methodology/soft-cell-assignment/","title":"Soft Cell Assignment","text":"<p>One of the central technical challenges in FAMAIL is that the objective function depends on discrete grid cell counts (e.g., \"how many pickups are in cell \\((i, j)\\)?\"), but gradient-based optimization requires continuous, differentiable functions. Assigning a pickup to a single grid cell is a step function \u2014 the gradient is zero almost everywhere.</p>"},{"location":"methodology/soft-cell-assignment/#the-problem","title":"The Problem","text":"<p>When a pickup location sits at continuous coordinates \\((3.2, 7.8)\\), the hard assignment says it belongs to cell \\((3, 7)\\). But if we shift the location slightly to \\((3.6, 7.8)\\), it still maps to cell \\((3, 7)\\) \u2014 the gradient provides no signal about how to move toward a different cell. Only at the exact boundary does the assignment change, and this produces an undefined (discontinuous) gradient.</p>"},{"location":"methodology/soft-cell-assignment/#the-solution","title":"The Solution","text":"<p>Soft cell assignment replaces the hard (one-cell) assignment with a probability distribution over nearby cells. Instead of saying \"this pickup is in cell \\((3, 7)\\),\" we say \"this pickup has probability 0.82 of being in cell \\((3, 7)\\), probability 0.08 in cell \\((3, 8)\\), probability 0.05 in cell \\((4, 7)\\),\" and so on.</p> <p>This is implemented as a Gaussian softmax over a local neighborhood:</p>   $$\\sigma_c(\\mathbf{p};\\, \\tau) = \\frac{\\exp\\!\\left(-\\|\\mathbf{p} - \\mathbf{c}\\|^2 \\;/\\; 2\\tau^2\\right)}{\\displaystyle\\sum_{c' \\in \\mathcal{N}} \\exp\\!\\left(-\\|\\mathbf{p} - \\mathbf{c}'\\|^2 \\;/\\; 2\\tau^2\\right)}$$   <p>where:</p> <ul> <li>\\(\\mathbf{p}\\) is the continuous pickup location</li> <li>\\(\\mathbf{c}\\) is the center of a grid cell</li> <li>\\(\\mathcal{N}\\) is the 5 \u00d7 5 neighborhood around the original cell</li> <li>\\(\\tau\\) is the temperature parameter</li> </ul>"},{"location":"methodology/soft-cell-assignment/#temperature-annealing","title":"Temperature Annealing","text":"<p>The temperature \\(\\tau\\) controls how \"soft\" or \"hard\" the assignment is:</p> Temperature Behavior When Used High (\\(\\tau \\to \\infty\\)) Probability spread uniformly across neighborhood Not used (theoretical limit) Moderate (\\(\\tau = 1.0\\)) Smooth distribution; broad gradients Early iterations (exploration) Low (\\(\\tau = 0.1\\)) Concentrated on nearest cell; nearly hard assignment Late iterations (precision) <p>During optimization, the temperature follows an exponential decay schedule:</p>   $$\\tau_t = \\tau_{\\max} \\cdot \\left(\\frac{\\tau_{\\min}}{\\tau_{\\max}}\\right)^{t/T}$$   <p>from \\(\\tau_{\\max} = 1.0\\) to \\(\\tau_{\\min} = 0.1\\). This creates a natural curriculum:</p> <ol> <li>Early iterations: Soft assignments produce non-zero gradients for all nearby cells, allowing the optimizer to explore broadly and \"see\" many candidate locations.</li> <li>Late iterations: Assignments sharpen to approximate the discrete reality, ensuring the final modified location corresponds to a definite grid cell.</li> </ol>"},{"location":"methodology/soft-cell-assignment/#the-full-gradient-path","title":"The Full Gradient Path","text":"<p>Soft cell assignment creates a differentiable chain from pickup location to objective value:</p> <pre><code>Pickup location (continuous, differentiable)\n        \u2193\nSoft cell probabilities (Gaussian softmax)\n        \u2193\nDifferentiable pickup counts per cell\n        \u2193\nSpatial fairness (Gini)  +  Causal fairness (R\u00b2)  +  Fidelity (discriminator)\n        \u2193\nCombined objective L\n        \u2193\nGradient \u2207_p L (via backpropagation)\n        \u2193\nPerturbation \u03b4 = clip(\u03b1 \u00b7 sign(\u2207_p L), -\u03b5, \u03b5)\n</code></pre> <p>Why this matters</p> <p>Without soft cell assignment, FAMAIL could not use gradient-based optimization at all. The entire pipeline \u2014 from continuous pickup locations through discrete cell counts to fairness metrics \u2014 would be non-differentiable. This module is the bridge that makes end-to-end learning possible.</p>"},{"location":"references/related-work/","title":"Foundations and Related Work","text":"<p>FAMAIL builds on research from several fields. The following works provide the theoretical and methodological foundations for the project.</p>"},{"location":"references/related-work/#imitation-learning-for-urban-mobility","title":"Imitation Learning for Urban Mobility","text":"<p>The cGAIL (Conditional Generative Adversarial Imitation Learning) framework provides the foundation for modeling expert taxi driver behavior. cGAIL trains agents to replicate human driving patterns using GPS trajectory data, producing the expert trajectories that FAMAIL subsequently edits for fairness.</p> <p>Zhang, X., et al. \"Conditional Generative Adversarial Imitation Learning for Taxi Driver Trajectories\"</p>"},{"location":"references/related-work/#adversarial-trajectory-perturbation","title":"Adversarial Trajectory Perturbation","text":"<p>The ST-iFGSM (Spatio-Temporal iterative Fast Gradient Sign Method) algorithm was originally developed for adversarial robustness testing of human mobility identification models. FAMAIL repurposes this technique: instead of attacking a model, we use gradient-based perturbation to improve a fairness objective.</p> <p>Zhang, X., et al. \"ST-iFGSM: Enhancing Robustness of Human Mobility Signature Identification Model via Spatial-Temporal Iterative FGSM\"</p>"},{"location":"references/related-work/#measuring-spatial-inequality-in-transportation","title":"Measuring Spatial Inequality in Transportation","text":"<p>The application of Gini coefficients to measure spatial inequality in taxi services \u2014 distinguishing between supply-side and demand-side inequality \u2014 provides the mathematical foundation for our spatial fairness term.</p> <p>Su, L., Yan, Z., &amp; Cao, J. (2018). \"Uncovering Spatial Inequality in Taxi Services in the Context of a Subsidy War among E-Hailing Apps\"</p>"},{"location":"references/related-work/#causal-approaches-to-fairness","title":"Causal Approaches to Fairness","text":"<p>The causal reasoning framework for algorithmic fairness \u2014 in particular, the idea that fairness requires ruling out the influence of sensitive attributes on outcomes \u2014 informs our causal fairness formulation.</p> <p>Kilbertus, N., et al. \"Avoiding Discrimination through Causal Reasoning\"</p>"},{"location":"references/team/","title":"Team","text":""},{"location":"references/team/#members","title":"Members","text":"Role Name Affiliation Researcher Robert Ashe San Diego State University Advisor Dr. Xin Zhang San Diego State University"},{"location":"references/team/#affiliation","title":"Affiliation","text":"<p>San Diego State University \u00b7 Department of Computer Science</p>"},{"location":"references/team/#project-timeline","title":"Project Timeline","text":"<p>2025\u20132026 (ongoing)</p>"}]}